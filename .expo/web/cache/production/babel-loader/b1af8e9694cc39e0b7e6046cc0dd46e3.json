{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{EventEmitter,UnavailabilityError}from'@unimodules/core';import Platform from\"react-native-web/dist/exports/Platform\";import uuidv4 from'uuid/v4';import ExponentFileSystem from\"./ExponentFileSystem\";import{EncodingType,FileSystemSessionType,FileSystemUploadType}from\"./FileSystem.types\";if(!ExponentFileSystem){console.warn(\"No native ExponentFileSystem module found, are you sure the expo-file-system's module is linked properly?\");}var _unused=new EventEmitter(ExponentFileSystem);export{EncodingType,FileSystemSessionType,FileSystemUploadType};function normalizeEndingSlash(p){if(p!=null){return p.replace(/\\/*$/,'')+'/';}return null;}export var documentDirectory=normalizeEndingSlash(ExponentFileSystem.documentDirectory);export var cacheDirectory=normalizeEndingSlash(ExponentFileSystem.cacheDirectory);var bundledAssets=ExponentFileSystem.bundledAssets,bundleDirectory=ExponentFileSystem.bundleDirectory;export{bundledAssets,bundleDirectory};export function getInfoAsync(fileUri){var options,_args=arguments;return _regeneratorRuntime.async(function getInfoAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:options=_args.length>1&&_args[1]!==undefined?_args[1]:{};if(ExponentFileSystem.getInfoAsync){_context.next=3;break;}throw new UnavailabilityError('expo-file-system','getInfoAsync');case 3:_context.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.getInfoAsync(fileUri,options));case 5:return _context.abrupt(\"return\",_context.sent);case 6:case\"end\":return _context.stop();}}},null,null,null,Promise);}export function readAsStringAsync(fileUri,options){return _regeneratorRuntime.async(function readAsStringAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(ExponentFileSystem.readAsStringAsync){_context2.next=2;break;}throw new UnavailabilityError('expo-file-system','readAsStringAsync');case 2:_context2.next=4;return _regeneratorRuntime.awrap(ExponentFileSystem.readAsStringAsync(fileUri,options||{}));case 4:return _context2.abrupt(\"return\",_context2.sent);case 5:case\"end\":return _context2.stop();}}},null,null,null,Promise);}export function getContentUriAsync(fileUri){return _regeneratorRuntime.async(function getContentUriAsync$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(Platform.OS==='android')){_context3.next=8;break;}if(ExponentFileSystem.getContentUriAsync){_context3.next=3;break;}throw new UnavailabilityError('expo-file-system','getContentUriAsync');case 3:_context3.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.getContentUriAsync(fileUri));case 5:return _context3.abrupt(\"return\",_context3.sent);case 8:return _context3.abrupt(\"return\",new Promise(function(resolve,reject){resolve(fileUri);}));case 9:case\"end\":return _context3.stop();}}},null,null,null,Promise);}export function writeAsStringAsync(fileUri,contents){var options,_args4=arguments;return _regeneratorRuntime.async(function writeAsStringAsync$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:options=_args4.length>2&&_args4[2]!==undefined?_args4[2]:{};if(ExponentFileSystem.writeAsStringAsync){_context4.next=3;break;}throw new UnavailabilityError('expo-file-system','writeAsStringAsync');case 3:_context4.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.writeAsStringAsync(fileUri,contents,options));case 5:return _context4.abrupt(\"return\",_context4.sent);case 6:case\"end\":return _context4.stop();}}},null,null,null,Promise);}export function deleteAsync(fileUri){var options,_args5=arguments;return _regeneratorRuntime.async(function deleteAsync$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:options=_args5.length>1&&_args5[1]!==undefined?_args5[1]:{};if(ExponentFileSystem.deleteAsync){_context5.next=3;break;}throw new UnavailabilityError('expo-file-system','deleteAsync');case 3:_context5.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.deleteAsync(fileUri,options));case 5:return _context5.abrupt(\"return\",_context5.sent);case 6:case\"end\":return _context5.stop();}}},null,null,null,Promise);}export function deleteLegacyDocumentDirectoryAndroid(){var legacyDocumentDirectory;return _regeneratorRuntime.async(function deleteLegacyDocumentDirectoryAndroid$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!(Platform.OS!=='android'||documentDirectory==null)){_context6.next=2;break;}return _context6.abrupt(\"return\");case 2:legacyDocumentDirectory=documentDirectory+\"ExperienceData/\";_context6.next=5;return _regeneratorRuntime.awrap(deleteAsync(legacyDocumentDirectory,{idempotent:true}));case 5:return _context6.abrupt(\"return\",_context6.sent);case 6:case\"end\":return _context6.stop();}}},null,null,null,Promise);}export function moveAsync(options){return _regeneratorRuntime.async(function moveAsync$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(ExponentFileSystem.moveAsync){_context7.next=2;break;}throw new UnavailabilityError('expo-file-system','moveAsync');case 2:_context7.next=4;return _regeneratorRuntime.awrap(ExponentFileSystem.moveAsync(options));case 4:return _context7.abrupt(\"return\",_context7.sent);case 5:case\"end\":return _context7.stop();}}},null,null,null,Promise);}export function copyAsync(options){return _regeneratorRuntime.async(function copyAsync$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(ExponentFileSystem.copyAsync){_context8.next=2;break;}throw new UnavailabilityError('expo-file-system','copyAsync');case 2:_context8.next=4;return _regeneratorRuntime.awrap(ExponentFileSystem.copyAsync(options));case 4:return _context8.abrupt(\"return\",_context8.sent);case 5:case\"end\":return _context8.stop();}}},null,null,null,Promise);}export function makeDirectoryAsync(fileUri){var options,_args9=arguments;return _regeneratorRuntime.async(function makeDirectoryAsync$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:options=_args9.length>1&&_args9[1]!==undefined?_args9[1]:{};if(ExponentFileSystem.makeDirectoryAsync){_context9.next=3;break;}throw new UnavailabilityError('expo-file-system','makeDirectoryAsync');case 3:_context9.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.makeDirectoryAsync(fileUri,options));case 5:return _context9.abrupt(\"return\",_context9.sent);case 6:case\"end\":return _context9.stop();}}},null,null,null,Promise);}export function readDirectoryAsync(fileUri){return _regeneratorRuntime.async(function readDirectoryAsync$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:if(ExponentFileSystem.readDirectoryAsync){_context10.next=2;break;}throw new UnavailabilityError('expo-file-system','readDirectoryAsync');case 2:_context10.next=4;return _regeneratorRuntime.awrap(ExponentFileSystem.readDirectoryAsync(fileUri,{}));case 4:return _context10.abrupt(\"return\",_context10.sent);case 5:case\"end\":return _context10.stop();}}},null,null,null,Promise);}export function getFreeDiskStorageAsync(){return _regeneratorRuntime.async(function getFreeDiskStorageAsync$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:if(ExponentFileSystem.getFreeDiskStorageAsync){_context11.next=2;break;}throw new UnavailabilityError('expo-file-system','getFreeDiskStorageAsync');case 2:_context11.next=4;return _regeneratorRuntime.awrap(ExponentFileSystem.getFreeDiskStorageAsync());case 4:return _context11.abrupt(\"return\",_context11.sent);case 5:case\"end\":return _context11.stop();}}},null,null,null,Promise);}export function getTotalDiskCapacityAsync(){return _regeneratorRuntime.async(function getTotalDiskCapacityAsync$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:if(ExponentFileSystem.getTotalDiskCapacityAsync){_context12.next=2;break;}throw new UnavailabilityError('expo-file-system','getTotalDiskCapacityAsync');case 2:_context12.next=4;return _regeneratorRuntime.awrap(ExponentFileSystem.getTotalDiskCapacityAsync());case 4:return _context12.abrupt(\"return\",_context12.sent);case 5:case\"end\":return _context12.stop();}}},null,null,null,Promise);}export function downloadAsync(uri,fileUri){var options,_args13=arguments;return _regeneratorRuntime.async(function downloadAsync$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:options=_args13.length>2&&_args13[2]!==undefined?_args13[2]:{};if(ExponentFileSystem.downloadAsync){_context13.next=3;break;}throw new UnavailabilityError('expo-file-system','downloadAsync');case 3:_context13.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.downloadAsync(uri,fileUri,_objectSpread({sessionType:FileSystemSessionType.BACKGROUND},options)));case 5:return _context13.abrupt(\"return\",_context13.sent);case 6:case\"end\":return _context13.stop();}}},null,null,null,Promise);}export function uploadAsync(url,fileUri){var options,_args14=arguments;return _regeneratorRuntime.async(function uploadAsync$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:options=_args14.length>2&&_args14[2]!==undefined?_args14[2]:{};if(ExponentFileSystem.uploadAsync){_context14.next=3;break;}throw new UnavailabilityError('expo-file-system','uploadAsync');case 3:_context14.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.uploadAsync(url,fileUri,_objectSpread(_objectSpread({sessionType:FileSystemSessionType.BACKGROUND,uploadType:FileSystemUploadType.BINARY_CONTENT},options),{},{httpMethod:(options.httpMethod||'POST').toUpperCase()})));case 5:return _context14.abrupt(\"return\",_context14.sent);case 6:case\"end\":return _context14.stop();}}},null,null,null,Promise);}export function createDownloadResumable(uri,fileUri,options,callback,resumeData){return new DownloadResumable(uri,fileUri,options,callback,resumeData);}export var DownloadResumable=function(){function DownloadResumable(url,fileUri){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var callback=arguments.length>3?arguments[3]:undefined;var resumeData=arguments.length>4?arguments[4]:undefined;_classCallCheck(this,DownloadResumable);this._uuid=uuidv4();this._url=url;this._fileUri=fileUri;this._options=options;this._resumeData=resumeData;this._callback=callback;this._subscription=null;this._emitter=new EventEmitter(ExponentFileSystem);}_createClass(DownloadResumable,[{key:\"downloadAsync\",value:function downloadAsync(){return _regeneratorRuntime.async(function downloadAsync$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:if(ExponentFileSystem.downloadResumableStartAsync){_context15.next=2;break;}throw new UnavailabilityError('expo-file-system','downloadResumableStartAsync');case 2:this._addSubscription();_context15.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.downloadResumableStartAsync(this._url,this._fileUri,this._uuid,this._options,this._resumeData));case 5:return _context15.abrupt(\"return\",_context15.sent);case 6:case\"end\":return _context15.stop();}}},null,this,null,Promise);}},{key:\"pauseAsync\",value:function pauseAsync(){var pauseResult;return _regeneratorRuntime.async(function pauseAsync$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:if(ExponentFileSystem.downloadResumablePauseAsync){_context16.next=2;break;}throw new UnavailabilityError('expo-file-system','downloadResumablePauseAsync');case 2:_context16.next=4;return _regeneratorRuntime.awrap(ExponentFileSystem.downloadResumablePauseAsync(this._uuid));case 4:pauseResult=_context16.sent;this._removeSubscription();if(!pauseResult){_context16.next=11;break;}this._resumeData=pauseResult.resumeData;return _context16.abrupt(\"return\",this.savable());case 11:throw new Error('Unable to generate a savable pause state');case 12:case\"end\":return _context16.stop();}}},null,this,null,Promise);}},{key:\"resumeAsync\",value:function resumeAsync(){return _regeneratorRuntime.async(function resumeAsync$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:if(ExponentFileSystem.downloadResumableStartAsync){_context17.next=2;break;}throw new UnavailabilityError('expo-file-system','downloadResumableStartAsync');case 2:this._addSubscription();_context17.next=5;return _regeneratorRuntime.awrap(ExponentFileSystem.downloadResumableStartAsync(this._url,this._fileUri,this._uuid,this._options,this._resumeData));case 5:return _context17.abrupt(\"return\",_context17.sent);case 6:case\"end\":return _context17.stop();}}},null,this,null,Promise);}},{key:\"savable\",value:function savable(){return{url:this._url,fileUri:this._fileUri,options:this._options,resumeData:this._resumeData};}},{key:\"_addSubscription\",value:function _addSubscription(){var _this=this;if(this._subscription){return;}this._subscription=this._emitter.addListener('expo-file-system.downloadProgress',function(event){if(event.uuid===_this._uuid){var callback=_this._callback;if(callback){callback(event.data);}}});}},{key:\"_removeSubscription\",value:function _removeSubscription(){if(!this._subscription){return;}this._emitter.removeSubscription(this._subscription);this._subscription=null;}}]);return DownloadResumable;}();","map":{"version":3,"sources":["../src/FileSystem.ts"],"names":[],"mappings":"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","sourcesContent":["import { EventEmitter, Subscription, UnavailabilityError } from '@unimodules/core';\nimport { Platform } from 'react-native';\nimport uuidv4 from 'uuid/v4';\n\nimport ExponentFileSystem from './ExponentFileSystem';\nimport {\n  DownloadOptions,\n  DownloadPauseState,\n  DownloadProgressCallback,\n  DownloadProgressData,\n  DownloadResult,\n  EncodingType,\n  FileInfo,\n  FileSystemAcceptedUploadHttpMethod,\n  FileSystemDownloadResult,\n  FileSystemSessionType,\n  FileSystemUploadOptions,\n  FileSystemUploadResult,\n  FileSystemUploadType,\n  ProgressEvent,\n  ReadingOptions,\n  WritingOptions,\n} from './FileSystem.types';\n\nif (!ExponentFileSystem) {\n  console.warn(\n    \"No native ExponentFileSystem module found, are you sure the expo-file-system's module is linked properly?\"\n  );\n}\n// Prevent webpack from pruning this.\nconst _unused = new EventEmitter(ExponentFileSystem); // eslint-disable-line\n\nexport {\n  DownloadOptions,\n  DownloadPauseState,\n  DownloadProgressCallback,\n  DownloadProgressData,\n  DownloadResult,\n  EncodingType,\n  FileInfo,\n  FileSystemDownloadResult,\n  FileSystemAcceptedUploadHttpMethod,\n  FileSystemSessionType,\n  FileSystemUploadOptions,\n  FileSystemUploadResult,\n  FileSystemUploadType,\n  ProgressEvent,\n  ReadingOptions,\n  WritingOptions,\n};\n\nfunction normalizeEndingSlash(p: string | null): string | null {\n  if (p != null) {\n    return p.replace(/\\/*$/, '') + '/';\n  }\n  return null;\n}\n\nexport const documentDirectory = normalizeEndingSlash(ExponentFileSystem.documentDirectory);\nexport const cacheDirectory = normalizeEndingSlash(ExponentFileSystem.cacheDirectory);\n\nexport const { bundledAssets, bundleDirectory } = ExponentFileSystem;\n\nexport async function getInfoAsync(\n  fileUri: string,\n  options: { md5?: boolean; size?: boolean } = {}\n): Promise<FileInfo> {\n  if (!ExponentFileSystem.getInfoAsync) {\n    throw new UnavailabilityError('expo-file-system', 'getInfoAsync');\n  }\n  return await ExponentFileSystem.getInfoAsync(fileUri, options);\n}\n\nexport async function readAsStringAsync(\n  fileUri: string,\n  options?: ReadingOptions\n): Promise<string> {\n  if (!ExponentFileSystem.readAsStringAsync) {\n    throw new UnavailabilityError('expo-file-system', 'readAsStringAsync');\n  }\n  return await ExponentFileSystem.readAsStringAsync(fileUri, options || {});\n}\n\nexport async function getContentUriAsync(fileUri: string): Promise<string> {\n  if (Platform.OS === 'android') {\n    if (!ExponentFileSystem.getContentUriAsync) {\n      throw new UnavailabilityError('expo-file-system', 'getContentUriAsync');\n    }\n    return await ExponentFileSystem.getContentUriAsync(fileUri);\n  } else {\n    return new Promise(function(resolve, reject) {\n      resolve(fileUri);\n    });\n  }\n}\n\nexport async function writeAsStringAsync(\n  fileUri: string,\n  contents: string,\n  options: WritingOptions = {}\n): Promise<void> {\n  if (!ExponentFileSystem.writeAsStringAsync) {\n    throw new UnavailabilityError('expo-file-system', 'writeAsStringAsync');\n  }\n  return await ExponentFileSystem.writeAsStringAsync(fileUri, contents, options);\n}\n\nexport async function deleteAsync(\n  fileUri: string,\n  options: { idempotent?: boolean } = {}\n): Promise<void> {\n  if (!ExponentFileSystem.deleteAsync) {\n    throw new UnavailabilityError('expo-file-system', 'deleteAsync');\n  }\n  return await ExponentFileSystem.deleteAsync(fileUri, options);\n}\n\nexport async function deleteLegacyDocumentDirectoryAndroid(): Promise<void> {\n  if (Platform.OS !== 'android' || documentDirectory == null) {\n    return;\n  }\n  const legacyDocumentDirectory = `${documentDirectory}ExperienceData/`;\n  return await deleteAsync(legacyDocumentDirectory, { idempotent: true });\n}\n\nexport async function moveAsync(options: { from: string; to: string }): Promise<void> {\n  if (!ExponentFileSystem.moveAsync) {\n    throw new UnavailabilityError('expo-file-system', 'moveAsync');\n  }\n  return await ExponentFileSystem.moveAsync(options);\n}\n\nexport async function copyAsync(options: { from: string; to: string }): Promise<void> {\n  if (!ExponentFileSystem.copyAsync) {\n    throw new UnavailabilityError('expo-file-system', 'copyAsync');\n  }\n  return await ExponentFileSystem.copyAsync(options);\n}\n\nexport async function makeDirectoryAsync(\n  fileUri: string,\n  options: { intermediates?: boolean } = {}\n): Promise<void> {\n  if (!ExponentFileSystem.makeDirectoryAsync) {\n    throw new UnavailabilityError('expo-file-system', 'makeDirectoryAsync');\n  }\n  return await ExponentFileSystem.makeDirectoryAsync(fileUri, options);\n}\n\nexport async function readDirectoryAsync(fileUri: string): Promise<string[]> {\n  if (!ExponentFileSystem.readDirectoryAsync) {\n    throw new UnavailabilityError('expo-file-system', 'readDirectoryAsync');\n  }\n  return await ExponentFileSystem.readDirectoryAsync(fileUri, {});\n}\n\nexport async function getFreeDiskStorageAsync(): Promise<number> {\n  if (!ExponentFileSystem.getFreeDiskStorageAsync) {\n    throw new UnavailabilityError('expo-file-system', 'getFreeDiskStorageAsync');\n  }\n  return await ExponentFileSystem.getFreeDiskStorageAsync();\n}\n\nexport async function getTotalDiskCapacityAsync(): Promise<number> {\n  if (!ExponentFileSystem.getTotalDiskCapacityAsync) {\n    throw new UnavailabilityError('expo-file-system', 'getTotalDiskCapacityAsync');\n  }\n  return await ExponentFileSystem.getTotalDiskCapacityAsync();\n}\n\nexport async function downloadAsync(\n  uri: string,\n  fileUri: string,\n  options: DownloadOptions = {}\n): Promise<FileSystemDownloadResult> {\n  if (!ExponentFileSystem.downloadAsync) {\n    throw new UnavailabilityError('expo-file-system', 'downloadAsync');\n  }\n\n  return await ExponentFileSystem.downloadAsync(uri, fileUri, {\n    sessionType: FileSystemSessionType.BACKGROUND,\n    ...options,\n  });\n}\n\nexport async function uploadAsync(\n  url: string,\n  fileUri: string,\n  options: FileSystemUploadOptions = {}\n): Promise<FileSystemUploadResult> {\n  if (!ExponentFileSystem.uploadAsync) {\n    throw new UnavailabilityError('expo-file-system', 'uploadAsync');\n  }\n\n  return await ExponentFileSystem.uploadAsync(url, fileUri, {\n    sessionType: FileSystemSessionType.BACKGROUND,\n    uploadType: FileSystemUploadType.BINARY_CONTENT,\n    ...options,\n    httpMethod: (options.httpMethod || 'POST').toUpperCase(),\n  });\n}\n\nexport function createDownloadResumable(\n  uri: string,\n  fileUri: string,\n  options?: DownloadOptions,\n  callback?: DownloadProgressCallback,\n  resumeData?: string\n): DownloadResumable {\n  return new DownloadResumable(uri, fileUri, options, callback, resumeData);\n}\n\nexport class DownloadResumable {\n  _uuid: string;\n  _url: string;\n  _fileUri: string;\n  _options: DownloadOptions;\n  _resumeData?: string;\n  _callback?: DownloadProgressCallback;\n  _subscription?: Subscription | null;\n  _emitter: EventEmitter;\n\n  constructor(\n    url: string,\n    fileUri: string,\n    options: DownloadOptions = {},\n    callback?: DownloadProgressCallback,\n    resumeData?: string\n  ) {\n    this._uuid = uuidv4();\n    this._url = url;\n    this._fileUri = fileUri;\n    this._options = options;\n    this._resumeData = resumeData;\n    this._callback = callback;\n    this._subscription = null;\n    this._emitter = new EventEmitter(ExponentFileSystem);\n  }\n\n  async downloadAsync(): Promise<FileSystemDownloadResult | undefined> {\n    if (!ExponentFileSystem.downloadResumableStartAsync) {\n      throw new UnavailabilityError('expo-file-system', 'downloadResumableStartAsync');\n    }\n    this._addSubscription();\n    return await ExponentFileSystem.downloadResumableStartAsync(\n      this._url,\n      this._fileUri,\n      this._uuid,\n      this._options,\n      this._resumeData\n    );\n  }\n\n  async pauseAsync(): Promise<DownloadPauseState> {\n    if (!ExponentFileSystem.downloadResumablePauseAsync) {\n      throw new UnavailabilityError('expo-file-system', 'downloadResumablePauseAsync');\n    }\n    const pauseResult = await ExponentFileSystem.downloadResumablePauseAsync(this._uuid);\n    this._removeSubscription();\n    if (pauseResult) {\n      this._resumeData = pauseResult.resumeData;\n      return this.savable();\n    } else {\n      throw new Error('Unable to generate a savable pause state');\n    }\n  }\n\n  async resumeAsync(): Promise<FileSystemDownloadResult | undefined> {\n    if (!ExponentFileSystem.downloadResumableStartAsync) {\n      throw new UnavailabilityError('expo-file-system', 'downloadResumableStartAsync');\n    }\n    this._addSubscription();\n    return await ExponentFileSystem.downloadResumableStartAsync(\n      this._url,\n      this._fileUri,\n      this._uuid,\n      this._options,\n      this._resumeData\n    );\n  }\n\n  savable(): DownloadPauseState {\n    return {\n      url: this._url,\n      fileUri: this._fileUri,\n      options: this._options,\n      resumeData: this._resumeData,\n    };\n  }\n\n  _addSubscription(): void {\n    if (this._subscription) {\n      return;\n    }\n    this._subscription = this._emitter.addListener(\n      'expo-file-system.downloadProgress',\n      (event: ProgressEvent) => {\n        if (event.uuid === this._uuid) {\n          const callback = this._callback;\n          if (callback) {\n            callback(event.data);\n          }\n        }\n      }\n    );\n  }\n\n  _removeSubscription(): void {\n    if (!this._subscription) {\n      return;\n    }\n    this._emitter.removeSubscription(this._subscription);\n    this._subscription = null;\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}